{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/View","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"4kYBDC6LJJXoH7P9rWDi3vkLVB0=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/StyleSheet","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"MK7+k1V+KnvCVW7Kj2k/ydtjmVU=","exportNames":["*"],"imports":1}},{"name":"react-native-webview","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":86},"end":{"line":3,"column":47,"index":133}}],"key":"YJc7i/oIweCWhKjzjfYLEcLeUJA=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/components/LeafletMap.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"LeafletMap\", {\n    enumerable: true,\n    get: function () {\n      return LeafletMap;\n    }\n  });\n  require(_dependencyMap[0], \"react\");\n  var _reactNativeWebDistExportsView = require(_dependencyMap[1], \"react-native-web/dist/exports/View\");\n  var View = _interopDefault(_reactNativeWebDistExportsView);\n  var _reactNativeWebDistExportsStyleSheet = require(_dependencyMap[2], \"react-native-web/dist/exports/StyleSheet\");\n  var StyleSheet = _interopDefault(_reactNativeWebDistExportsStyleSheet);\n  var _reactNativeWebview = require(_dependencyMap[3], \"react-native-webview\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const LeafletMap = ({\n    vehicles,\n    onMarkerClick,\n    center = [35.3764, 1.3218],\n    zoom = 13,\n    focusedVehicleImei = null\n  }) => {\n    // Generate HTML for Leaflet map\n    const generateMapHTML = () => {\n      const vehiclesJSON = JSON.stringify(vehicles);\n      const centerJSON = JSON.stringify(vehicles && vehicles.length > 0 ? [vehicles[0].lat, vehicles[0].lng] : center);\n      return `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\n  <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n  <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n  <style>\n    body, html { margin: 0; padding: 0; height: 100%; }\n    #map { height: 100%; width: 100%; }\n  </style>\n</head>\n<body>\n  <div id=\"map\"></div>\n  <script>\n    const vehicles = ${vehiclesJSON};\n    const center = ${centerJSON};\n    \n    // Initialize map\n    const map = L.map('map').setView(center, ${zoom});\n    \n    // Add OpenStreetMap tiles\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19\n    }).addTo(map);\n    \n    // Add markers for each vehicle with arrow icons\n    vehicles.forEach(vehicle => {\n      // Create arrow SVG pointing in the direction of vehicle movement\n      const arrowSvg = \\`\n        <svg width=\"40\" height=\"50\" viewBox=\"0 0 40 50\" xmlns=\"http://www.w3.org/2000/svg\" \n             style=\"transform: rotate(\\${vehicle.angle}deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));\">\n          <path d=\"M20 5 L35 30 L25 30 L25 45 L15 45 L15 30 L5 30 Z\" \n                fill=\"\\${vehicle.color}\" \n                stroke=\"white\" \n                stroke-width=\"2\"/>\n        </svg>\n      \\`;\n      \n      // Add vehicle name below the arrow\n      const icon = L.divIcon({\n        className: 'custom-vehicle-marker',\n        html: \\`\n          <div style=\"text-align: center; width: 80px; margin-left: -20px;\">\n            \\${arrowSvg}\n            <div style=\"\n              font-family: Arial, sans-serif;\n              font-size: 10px;\n              font-weight: bold;\n              color: #333;\n              background-color: rgba(255,255,255,0.9);\n              padding: 2px 4px;\n              border-radius: 3px;\n              margin-top: -5px;\n              box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n              white-space: nowrap;\n              overflow: hidden;\n              text-overflow: ellipsis;\n            \">\\${vehicle.name}</div>\n          </div>\n        \\`,\n        iconSize: [40, 65],\n        iconAnchor: [20, 45]\n      });\n      \n      const marker = L.marker([vehicle.lat, vehicle.lng], { icon })\n        .addTo(map)\n        .bindPopup(\\`\n          <div style=\"min-width: 150px; font-family: Arial, sans-serif;\">\n            <strong style=\"font-size: 16px; color: #333;\">\\${vehicle.name}</strong><br/>\n            <span style=\"font-size: 14px; color: #666;\">Vitesse: \\${vehicle.speed.toFixed(0)} km/h</span><br/>\n            <span style=\"font-size: 14px; color: #666;\">Direction: \\${vehicle.angle.toFixed(0)}°</span><br/>\n            <span style=\"font-size: 14px; color: #666;\">Statut: \\${vehicle.status}</span>\n          </div>\n        \\`);\n        \n      marker.on('click', () => {\n        if (window.ReactNativeWebView) {\n          window.ReactNativeWebView.postMessage(JSON.stringify({\n            type: 'markerClick',\n            imei: vehicle.imei\n          }));\n        }\n      });\n    });\n    \n    // Fit bounds to show all vehicles\n    if (vehicles.length > 0) {\n      const bounds = vehicles.map(v => [v.lat, v.lng]);\n      map.fitBounds(bounds, { padding: [50, 50] });\n    }\n  </script>\n</body>\n</html>\n    `;\n    };\n    const handleMessage = event => {\n      try {\n        const data = JSON.parse(event.nativeEvent.data);\n        if (data.type === 'markerClick' && onMarkerClick) {\n          onMarkerClick(data.imei);\n        }\n      } catch (error) {\n        console.error('Error parsing WebView message:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(View.default, {\n      style: styles.container,\n      children: /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNativeWebview.WebView, {\n        source: {\n          html: generateMapHTML()\n        },\n        style: styles.webview,\n        onMessage: handleMessage,\n        javaScriptEnabled: true,\n        domStorageEnabled: true,\n        originWhitelist: ['*']\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 5\n    }, this);\n  };\n  _c = LeafletMap;\n  const styles = StyleSheet.default.create({\n    container: {\n      flex: 1\n    },\n    webview: {\n      flex: 1\n    }\n  });\n  var _default = LeafletMap;\n  var _c;\n  $RefreshReg$(_c, \"LeafletMap\");\n});","lineCount":184,"map":[[13,2,168,0,"Object"],[13,8,168,0],[13,9,168,0,"defineProperty"],[13,23,168,0],[13,24,168,0,"exports"],[13,31,168,0],[14,4,168,0,"enumerable"],[14,14,168,0],[15,4,168,0,"get"],[15,7,168,0],[15,18,168,0,"get"],[15,19,168,0],[16,6,168,0],[16,13,168,0,"_default"],[16,21,168,0],[17,4,168,0],[18,2,168,0],[19,2,24,0,"Object"],[19,8,24,0],[19,9,24,0,"defineProperty"],[19,23,24,0],[19,24,24,0,"exports"],[19,31,24,0],[20,4,24,0,"enumerable"],[20,14,24,0],[21,4,24,0,"get"],[21,7,24,0],[21,18,24,0,"get"],[21,19,24,0],[22,6,24,0],[22,13,24,0,"LeafletMap"],[22,23,24,0],[23,4,24,0],[24,2,24,0],[25,2,1,0,"require"],[25,9,1,0],[25,10,1,0,"_dependencyMap"],[25,24,1,0],[26,2,1,26],[26,6,1,26,"_reactNativeWebDistExportsView"],[26,36,1,26],[26,39,1,26,"require"],[26,46,1,26],[26,47,1,26,"_dependencyMap"],[26,61,1,26],[27,2,1,26],[27,6,1,26,"View"],[27,10,1,26],[27,13,1,26,"_interopDefault"],[27,28,1,26],[27,29,1,26,"_reactNativeWebDistExportsView"],[27,59,1,26],[28,2,1,26],[28,6,1,26,"_reactNativeWebDistExportsStyleSheet"],[28,42,1,26],[28,45,1,26,"require"],[28,52,1,26],[28,53,1,26,"_dependencyMap"],[28,67,1,26],[29,2,1,26],[29,6,1,26,"StyleSheet"],[29,16,1,26],[29,19,1,26,"_interopDefault"],[29,34,1,26],[29,35,1,26,"_reactNativeWebDistExportsStyleSheet"],[29,71,1,26],[30,2,3,0],[30,6,3,0,"_reactNativeWebview"],[30,25,3,0],[30,28,3,0,"require"],[30,35,3,0],[30,36,3,0,"_dependencyMap"],[30,50,3,0],[31,2,3,47],[31,6,3,47,"_reactJsxDevRuntime"],[31,25,3,47],[31,28,3,47,"require"],[31,35,3,47],[31,36,3,47,"_dependencyMap"],[31,50,3,47],[32,2,24,7],[32,8,24,13,"LeafletMap"],[32,18,24,50],[32,21,24,53,"LeafletMap"],[32,22,24,54],[33,4,25,2,"vehicles"],[33,12,25,10],[34,4,26,2,"onMarkerClick"],[34,17,26,15],[35,4,27,2,"center"],[35,10,27,8],[35,13,27,11],[35,14,27,12],[35,21,27,19],[35,23,27,21],[35,29,27,27],[35,30,27,28],[36,4,28,2,"zoom"],[36,8,28,6],[36,11,28,9],[36,13,28,11],[37,4,29,2,"focusedVehicleImei"],[37,22,29,20],[37,25,29,23],[38,2,30,0],[38,3,30,1],[38,8,30,6],[39,4,31,2],[40,4,32,2],[40,10,32,8,"generateMapHTML"],[40,25,32,23],[40,28,32,26,"generateMapHTML"],[40,29,32,26],[40,34,32,32],[41,6,33,4],[41,12,33,10,"vehiclesJSON"],[41,24,33,22],[41,27,33,25,"JSON"],[41,31,33,29],[41,32,33,30,"stringify"],[41,41,33,39],[41,42,33,40,"vehicles"],[41,50,33,48],[41,51,33,49],[42,6,34,4],[42,12,34,10,"centerJSON"],[42,22,34,20],[42,25,34,23,"JSON"],[42,29,34,27],[42,30,34,28,"stringify"],[42,39,34,37],[42,40,34,38,"vehicles"],[42,48,34,46],[42,52,34,50,"vehicles"],[42,60,34,58],[42,61,34,59,"length"],[42,67,34,65],[42,70,34,68],[42,71,34,69],[42,74,34,72],[42,75,34,73,"vehicles"],[42,83,34,81],[42,84,34,82],[42,85,34,83],[42,86,34,84],[42,87,34,85,"lat"],[42,90,34,88],[42,92,34,90,"vehicles"],[42,100,34,98],[42,101,34,99],[42,102,34,100],[42,103,34,101],[42,104,34,102,"lng"],[42,107,34,105],[42,108,34,106],[42,111,34,109,"center"],[42,117,34,115],[42,118,34,116],[43,6,36,4],[43,13,36,11],[44,0,37,0],[45,0,38,0],[46,0,39,0],[47,0,40,0],[48,0,41,0],[49,0,42,0],[50,0,43,0],[51,0,44,0],[52,0,45,0],[53,0,46,0],[54,0,47,0],[55,0,48,0],[56,0,49,0],[57,0,50,0],[58,0,51,0],[58,23,51,23,"vehiclesJSON"],[58,35,51,35],[59,0,52,0],[59,21,52,21,"centerJSON"],[59,31,52,31],[60,0,53,0],[61,0,54,0],[62,0,55,0],[62,47,55,47,"zoom"],[62,51,55,51],[63,0,56,0],[64,0,57,0],[65,0,58,0],[66,0,59,0],[67,0,60,0],[68,0,61,0],[69,0,62,0],[70,0,63,0],[71,0,64,0],[72,0,65,0],[73,0,66,0],[74,0,67,0],[75,0,68,0],[76,0,69,0],[77,0,70,0],[78,0,71,0],[79,0,72,0],[80,0,73,0],[81,0,74,0],[82,0,75,0],[83,0,76,0],[84,0,77,0],[85,0,78,0],[86,0,79,0],[87,0,80,0],[88,0,81,0],[89,0,82,0],[90,0,83,0],[91,0,84,0],[92,0,85,0],[93,0,86,0],[94,0,87,0],[95,0,88,0],[96,0,89,0],[97,0,90,0],[98,0,91,0],[99,0,92,0],[100,0,93,0],[101,0,94,0],[102,0,95,0],[103,0,96,0],[104,0,97,0],[105,0,98,0],[106,0,99,0],[107,0,100,0],[108,0,101,0],[109,0,102,0],[110,0,103,0],[111,0,104,0],[112,0,105,0],[113,0,106,0],[114,0,107,0],[115,0,108,0],[116,0,109,0],[117,0,110,0],[118,0,111,0],[119,0,112,0],[120,0,113,0],[121,0,114,0],[122,0,115,0],[123,0,116,0],[124,0,117,0],[125,0,118,0],[126,0,119,0],[127,0,120,0],[128,0,121,0],[129,0,122,0],[130,0,123,0],[131,0,124,0],[132,0,125,0],[133,0,126,0],[134,0,127,0],[135,0,128,0],[136,0,129,0],[137,0,130,0],[138,0,131,0],[138,5,131,5],[139,4,132,2],[139,5,132,3],[140,4,134,2],[140,10,134,8,"handleMessage"],[140,23,134,21],[140,26,134,25,"event"],[140,31,134,35],[140,35,134,40],[141,6,135,4],[141,10,135,8],[142,8,136,6],[142,14,136,12,"data"],[142,18,136,16],[142,21,136,19,"JSON"],[142,25,136,23],[142,26,136,24,"parse"],[142,31,136,29],[142,32,136,30,"event"],[142,37,136,35],[142,38,136,36,"nativeEvent"],[142,49,136,47],[142,50,136,48,"data"],[142,54,136,52],[142,55,136,53],[143,8,137,6],[143,12,137,10,"data"],[143,16,137,14],[143,17,137,15,"type"],[143,21,137,19],[143,26,137,24],[143,39,137,37],[143,43,137,41,"onMarkerClick"],[143,56,137,54],[143,58,137,56],[144,10,138,8,"onMarkerClick"],[144,23,138,21],[144,24,138,22,"data"],[144,28,138,26],[144,29,138,27,"imei"],[144,33,138,31],[144,34,138,32],[145,8,139,6],[146,6,140,4],[146,7,140,5],[146,8,140,6],[146,15,140,13,"error"],[146,20,140,18],[146,22,140,20],[147,8,141,6,"console"],[147,15,141,13],[147,16,141,14,"error"],[147,21,141,19],[147,22,141,20],[147,54,141,52],[147,56,141,54,"error"],[147,61,141,59],[147,62,141,60],[148,6,142,4],[149,4,143,2],[149,5,143,3],[150,4,145,2],[150,24,146,4],[150,28,146,4,"_reactJsxDevRuntime"],[150,47,146,4],[150,48,146,4,"jsxDEV"],[150,54,146,4],[150,56,146,5,"View"],[150,60,146,9],[150,61,146,9,"default"],[150,68,146,9],[151,6,146,10,"style"],[151,11,146,15],[151,13,146,17,"styles"],[151,19,146,23],[151,20,146,24,"container"],[151,29,146,34],[152,6,146,34,"children"],[152,14,146,34],[152,29,147,6],[152,33,147,6,"_reactJsxDevRuntime"],[152,52,147,6],[152,53,147,6,"jsxDEV"],[152,59,147,6],[152,61,147,7,"_reactNativeWebview"],[152,80,147,14],[152,81,147,14,"WebView"],[152,88,147,14],[153,8,148,8,"source"],[153,14,148,14],[153,16,148,16],[154,10,148,18,"html"],[154,14,148,22],[154,16,148,24,"generateMapHTML"],[154,31,148,39],[154,32,148,40],[155,8,148,42],[155,9,148,44],[156,8,149,8,"style"],[156,13,149,13],[156,15,149,15,"styles"],[156,21,149,21],[156,22,149,22,"webview"],[156,29,149,30],[157,8,150,8,"onMessage"],[157,17,150,17],[157,19,150,19,"handleMessage"],[157,32,150,33],[158,8,151,8,"javaScriptEnabled"],[158,25,151,25],[158,27,151,27],[158,31,151,32],[159,8,152,8,"domStorageEnabled"],[159,25,152,25],[159,27,152,27],[159,31,152,32],[160,8,153,8,"originWhitelist"],[160,23,153,23],[160,25,153,25],[160,26,153,26],[160,29,153,29],[161,6,153,31],[162,8,153,31,"fileName"],[162,16,153,31],[162,18,153,31,"_jsxFileName"],[162,30,153,31],[163,8,153,31,"lineNumber"],[163,18,153,31],[164,8,153,31,"columnNumber"],[164,20,153,31],[165,6,153,31],[165,13,154,7],[166,4,154,8],[167,6,154,8,"fileName"],[167,14,154,8],[167,16,154,8,"_jsxFileName"],[167,28,154,8],[168,6,154,8,"lineNumber"],[168,16,154,8],[169,6,154,8,"columnNumber"],[169,18,154,8],[170,4,154,8],[170,11,155,10],[170,12,155,11],[171,2,157,0],[171,3,157,1],[172,2,157,2,"_c"],[172,4,157,2],[172,7,24,13,"LeafletMap"],[172,17,24,50],[173,2,159,0],[173,8,159,6,"styles"],[173,14,159,12],[173,17,159,15,"StyleSheet"],[173,27,159,25],[173,28,159,25,"default"],[173,35,159,25],[173,36,159,26,"create"],[173,42,159,32],[173,43,159,33],[174,4,160,2,"container"],[174,13,160,11],[174,15,160,13],[175,6,161,4,"flex"],[175,10,161,8],[175,12,161,10],[176,4,162,2],[176,5,162,3],[177,4,163,2,"webview"],[177,11,163,9],[177,13,163,11],[178,6,164,4,"flex"],[178,10,164,8],[178,12,164,10],[179,4,165,2],[180,2,166,0],[180,3,166,1],[180,4,166,2],[181,2,168,0],[181,6,168,0,"_default"],[181,14,168,0],[181,17,168,15,"LeafletMap"],[181,27,168,25],[182,2,168,26],[182,6,168,26,"_c"],[182,8,168,26],[183,2,168,26,"$RefreshReg$"],[183,14,168,26],[183,15,168,26,"_c"],[183,17,168,26],[184,0,168,26],[184,3]],"functionMap":{"names":["<global>","LeafletMap","generateMapHTML","handleMessage"],"mappings":"AAA;qDCuB;0BCQ;GDoG;wBEE;GFS;CDc"},"hasCjsExports":false},"type":"js/module"}]}