{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":27},"end":{"line":2,"column":58,"index":85}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"react-native-webview","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":86},"end":{"line":3,"column":47,"index":133}}],"key":"YJc7i/oIweCWhKjzjfYLEcLeUJA=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/components/LeafletMap.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"LeafletMap\", {\n    enumerable: true,\n    get: function () {\n      return LeafletMap;\n    }\n  });\n  require(_dependencyMap[0], \"react\");\n  var _reactNative = require(_dependencyMap[1], \"react-native\");\n  var _reactNativeWebview = require(_dependencyMap[2], \"react-native-webview\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  var LeafletMap = _ref => {\n    var vehicles = _ref.vehicles,\n      onMarkerClick = _ref.onMarkerClick,\n      _ref$center = _ref.center,\n      center = _ref$center === void 0 ? [35.3764, 1.3218] : _ref$center,\n      _ref$zoom = _ref.zoom,\n      zoom = _ref$zoom === void 0 ? 13 : _ref$zoom,\n      _ref$focusedVehicleIm = _ref.focusedVehicleImei,\n      focusedVehicleImei = _ref$focusedVehicleIm === void 0 ? null : _ref$focusedVehicleIm,\n      _ref$mapType = _ref.mapType,\n      mapType = _ref$mapType === void 0 ? 'leaflet' : _ref$mapType;\n    // Generate HTML for Leaflet map\n    var generateMapHTML = () => {\n      var vehiclesJSON = JSON.stringify(vehicles);\n      var centerJSON = JSON.stringify(vehicles && vehicles.length > 0 ? [vehicles[0].lat, vehicles[0].lng] : center);\n\n      // Define tile layers based on map type\n      var tileLayerConfig = '';\n      if (mapType === 'arcgis') {\n        tileLayerConfig = `\n        L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {\n          attribution: '© Esri, Maxar, Earthstar Geographics',\n          maxZoom: 19\n        }).addTo(map);\n      `;\n      } else if (mapType === 'mapbox') {\n        tileLayerConfig = `\n        L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/satellite-v9/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {\n          attribution: '© Mapbox © OpenStreetMap',\n          maxZoom: 19,\n          tileSize: 512,\n          zoomOffset: -1\n        }).addTo(map);\n      `;\n      } else {\n        tileLayerConfig = `\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          attribution: '© OpenStreetMap contributors',\n          maxZoom: 19\n        }).addTo(map);\n      `;\n      }\n      return `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\n  <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n  <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n  <style>\n    body, html { margin: 0; padding: 0; height: 100%; }\n    #map { height: 100%; width: 100%; }\n  </style>\n</head>\n<body>\n  <div id=\"map\"></div>\n  <script>\n    const vehicles = ${vehiclesJSON};\n    const center = ${centerJSON};\n    \n    // Initialize map\n    const map = L.map('map').setView(center, ${zoom});\n    \n    // Add selected tile layer\n    ${tileLayerConfig}\n    \n    // Add markers for each vehicle with arrow icons\n    vehicles.forEach(vehicle => {\n      // Create arrow SVG pointing in the direction of vehicle movement\n      const arrowSvg = \\`\n        <svg width=\"24\" height=\"30\" viewBox=\"0 0 24 30\" xmlns=\"http://www.w3.org/2000/svg\" \n             style=\"transform: rotate(\\${vehicle.angle}deg); filter: drop-shadow(0 1px 3px rgba(0,0,0,0.3));\">\n          <path d=\"M12 3 L21 18 L15 18 L15 27 L9 27 L9 18 L3 18 Z\" \n                fill=\"\\${vehicle.color}\" \n                stroke=\"white\" \n                stroke-width=\"1.5\"/>\n        </svg>\n      \\`;\n      \n      // Add vehicle name below the arrow\n      const icon = L.divIcon({\n        className: 'custom-vehicle-marker',\n        html: \\`\n          <div style=\"text-align: center; width: 60px; margin-left: -18px;\">\n            \\${arrowSvg}\n            <div style=\"\n              font-family: Arial, sans-serif;\n              font-size: 9px;\n              font-weight: bold;\n              color: #333;\n              background-color: rgba(255,255,255,0.95);\n              padding: 1px 3px;\n              border-radius: 3px;\n              margin-top: -3px;\n              box-shadow: 0 1px 2px rgba(0,0,0,0.2);\n              white-space: nowrap;\n              overflow: hidden;\n              text-overflow: ellipsis;\n            \">\\${vehicle.name}</div>\n          </div>\n        \\`,\n        iconSize: [24, 45],\n        iconAnchor: [12, 30]\n      });\n      \n      const marker = L.marker([vehicle.lat, vehicle.lng], { icon })\n        .addTo(map)\n        .bindPopup(\\`\n          <div style=\"min-width: 150px; font-family: Arial, sans-serif;\">\n            <strong style=\"font-size: 16px; color: #333;\">\\${vehicle.name}</strong><br/>\n            <span style=\"font-size: 14px; color: #666;\">Vitesse: \\${vehicle.speed.toFixed(0)} km/h</span><br/>\n            <span style=\"font-size: 14px; color: #666;\">Direction: \\${vehicle.angle.toFixed(0)}°</span><br/>\n            <span style=\"font-size: 14px; color: #666;\">Statut: \\${vehicle.status}</span>\n          </div>\n        \\`);\n        \n      marker.on('click', () => {\n        if (window.ReactNativeWebView) {\n          window.ReactNativeWebView.postMessage(JSON.stringify({\n            type: 'markerClick',\n            imei: vehicle.imei\n          }));\n        }\n      });\n    });\n    \n    // Fit bounds to show all vehicles\n    if (vehicles.length > 0) {\n      const bounds = vehicles.map(v => [v.lat, v.lng]);\n      map.fitBounds(bounds, { padding: [50, 50] });\n    }\n  </script>\n</body>\n</html>\n    `;\n    };\n    var handleMessage = event => {\n      try {\n        var data = JSON.parse(event.nativeEvent.data);\n        if (data.type === 'markerClick' && onMarkerClick) {\n          onMarkerClick(data.imei);\n        }\n      } catch (error) {\n        console.error('Error parsing WebView message:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNative.View, {\n      style: styles.container,\n      children: /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNativeWebview.WebView, {\n        source: {\n          html: generateMapHTML()\n        },\n        style: styles.webview,\n        onMessage: handleMessage,\n        javaScriptEnabled: true,\n        domStorageEnabled: true,\n        originWhitelist: ['*']\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 5\n    }, this);\n  };\n  _c = LeafletMap;\n  var styles = _reactNative.StyleSheet.create({\n    container: {\n      flex: 1\n    },\n    webview: {\n      flex: 1\n    }\n  });\n  var _default = LeafletMap;\n  var _c;\n  $RefreshReg$(_c, \"LeafletMap\");\n});","lineCount":204,"map":[[8,2,194,0,"Object"],[8,8,194,0],[8,9,194,0,"defineProperty"],[8,23,194,0],[8,24,194,0,"exports"],[8,31,194,0],[9,4,194,0,"enumerable"],[9,14,194,0],[10,4,194,0,"get"],[10,7,194,0],[10,18,194,0,"get"],[10,19,194,0],[11,6,194,0],[11,13,194,0,"_default"],[11,21,194,0],[12,4,194,0],[13,2,194,0],[14,2,25,0,"Object"],[14,8,25,0],[14,9,25,0,"defineProperty"],[14,23,25,0],[14,24,25,0,"exports"],[14,31,25,0],[15,4,25,0,"enumerable"],[15,14,25,0],[16,4,25,0,"get"],[16,7,25,0],[16,18,25,0,"get"],[16,19,25,0],[17,6,25,0],[17,13,25,0,"LeafletMap"],[17,23,25,0],[18,4,25,0],[19,2,25,0],[20,2,1,0,"require"],[20,9,1,0],[20,10,1,0,"_dependencyMap"],[20,24,1,0],[21,2,2,0],[21,6,2,0,"_reactNative"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_reactNativeWebview"],[22,25,3,0],[22,28,3,0,"require"],[22,35,3,0],[22,36,3,0,"_dependencyMap"],[22,50,3,0],[23,2,3,47],[23,6,3,47,"_reactJsxDevRuntime"],[23,25,3,47],[23,28,3,47,"require"],[23,35,3,47],[23,36,3,47,"_dependencyMap"],[23,50,3,47],[24,2,25,7],[24,6,25,13,"LeafletMap"],[24,16,25,50],[24,19,25,53,"_ref"],[24,23,25,53],[24,27,32,6],[25,4,32,6],[25,8,26,2,"vehicles"],[25,16,26,10],[25,19,26,10,"_ref"],[25,23,26,10],[25,24,26,2,"vehicles"],[25,32,26,10],[26,6,27,2,"onMarkerClick"],[26,19,27,15],[26,22,27,15,"_ref"],[26,26,27,15],[26,27,27,2,"onMarkerClick"],[26,40,27,15],[27,6,27,15,"_ref$center"],[27,17,27,15],[27,20,27,15,"_ref"],[27,24,27,15],[27,25,28,2,"center"],[27,31,28,8],[28,6,28,2,"center"],[28,12,28,8],[28,15,28,8,"_ref$center"],[28,26,28,8],[28,40,28,11],[28,41,28,12],[28,48,28,19],[28,50,28,21],[28,56,28,27],[28,57,28,28],[28,60,28,28,"_ref$center"],[28,71,28,28],[29,6,28,28,"_ref$zoom"],[29,15,28,28],[29,18,28,28,"_ref"],[29,22,28,28],[29,23,29,2,"zoom"],[29,27,29,6],[30,6,29,2,"zoom"],[30,10,29,6],[30,13,29,6,"_ref$zoom"],[30,22,29,6],[30,36,29,9],[30,38,29,11],[30,41,29,11,"_ref$zoom"],[30,50,29,11],[31,6,29,11,"_ref$focusedVehicleIm"],[31,27,29,11],[31,30,29,11,"_ref"],[31,34,29,11],[31,35,30,2,"focusedVehicleImei"],[31,53,30,20],[32,6,30,2,"focusedVehicleImei"],[32,24,30,20],[32,27,30,20,"_ref$focusedVehicleIm"],[32,48,30,20],[32,62,30,23],[32,66,30,27],[32,69,30,27,"_ref$focusedVehicleIm"],[32,90,30,27],[33,6,30,27,"_ref$mapType"],[33,18,30,27],[33,21,30,27,"_ref"],[33,25,30,27],[33,26,31,2,"mapType"],[33,33,31,9],[34,6,31,2,"mapType"],[34,13,31,9],[34,16,31,9,"_ref$mapType"],[34,28,31,9],[34,42,31,12],[34,51,31,21],[34,54,31,21,"_ref$mapType"],[34,66,31,21],[35,4,33,2],[36,4,34,2],[36,8,34,8,"generateMapHTML"],[36,23,34,23],[36,26,34,26,"generateMapHTML"],[36,27,34,26],[36,32,34,32],[37,6,35,4],[37,10,35,10,"vehiclesJSON"],[37,22,35,22],[37,25,35,25,"JSON"],[37,29,35,29],[37,30,35,30,"stringify"],[37,39,35,39],[37,40,35,40,"vehicles"],[37,48,35,48],[37,49,35,49],[38,6,36,4],[38,10,36,10,"centerJSON"],[38,20,36,20],[38,23,36,23,"JSON"],[38,27,36,27],[38,28,36,28,"stringify"],[38,37,36,37],[38,38,36,38,"vehicles"],[38,46,36,46],[38,50,36,50,"vehicles"],[38,58,36,58],[38,59,36,59,"length"],[38,65,36,65],[38,68,36,68],[38,69,36,69],[38,72,36,72],[38,73,36,73,"vehicles"],[38,81,36,81],[38,82,36,82],[38,83,36,83],[38,84,36,84],[38,85,36,85,"lat"],[38,88,36,88],[38,90,36,90,"vehicles"],[38,98,36,98],[38,99,36,99],[38,100,36,100],[38,101,36,101],[38,102,36,102,"lng"],[38,105,36,105],[38,106,36,106],[38,109,36,109,"center"],[38,115,36,115],[38,116,36,116],[40,6,38,4],[41,6,39,4],[41,10,39,8,"tileLayerConfig"],[41,25,39,23],[41,28,39,26],[41,30,39,28],[42,6,40,4],[42,10,40,8,"mapType"],[42,17,40,15],[42,22,40,20],[42,30,40,28],[42,32,40,30],[43,8,41,6,"tileLayerConfig"],[43,23,41,21],[43,26,41,24],[44,0,42,0],[45,0,43,0],[46,0,44,0],[47,0,45,0],[48,0,46,0],[48,7,46,7],[49,6,47,4],[49,7,47,5],[49,13,47,11],[49,17,47,15,"mapType"],[49,24,47,22],[49,29,47,27],[49,37,47,35],[49,39,47,37],[50,8,48,6,"tileLayerConfig"],[50,23,48,21],[50,26,48,24],[51,0,49,0],[52,0,50,0],[53,0,51,0],[54,0,52,0],[55,0,53,0],[56,0,54,0],[57,0,55,0],[57,7,55,7],[58,6,56,4],[58,7,56,5],[58,13,56,11],[59,8,57,6,"tileLayerConfig"],[59,23,57,21],[59,26,57,24],[60,0,58,0],[61,0,59,0],[62,0,60,0],[63,0,61,0],[64,0,62,0],[64,7,62,7],[65,6,63,4],[66,6,65,4],[66,13,65,11],[67,0,66,0],[68,0,67,0],[69,0,68,0],[70,0,69,0],[71,0,70,0],[72,0,71,0],[73,0,72,0],[74,0,73,0],[75,0,74,0],[76,0,75,0],[77,0,76,0],[78,0,77,0],[79,0,78,0],[80,0,79,0],[81,0,80,0],[81,23,80,23,"vehiclesJSON"],[81,35,80,35],[82,0,81,0],[82,21,81,21,"centerJSON"],[82,31,81,31],[83,0,82,0],[84,0,83,0],[85,0,84,0],[85,47,84,47,"zoom"],[85,51,84,51],[86,0,85,0],[87,0,86,0],[88,0,87,0],[88,6,87,6,"tileLayerConfig"],[88,21,87,21],[89,0,88,0],[90,0,89,0],[91,0,90,0],[92,0,91,0],[93,0,92,0],[94,0,93,0],[95,0,94,0],[96,0,95,0],[97,0,96,0],[98,0,97,0],[99,0,98,0],[100,0,99,0],[101,0,100,0],[102,0,101,0],[103,0,102,0],[104,0,103,0],[105,0,104,0],[106,0,105,0],[107,0,106,0],[108,0,107,0],[109,0,108,0],[110,0,109,0],[111,0,110,0],[112,0,111,0],[113,0,112,0],[114,0,113,0],[115,0,114,0],[116,0,115,0],[117,0,116,0],[118,0,117,0],[119,0,118,0],[120,0,119,0],[121,0,120,0],[122,0,121,0],[123,0,122,0],[124,0,123,0],[125,0,124,0],[126,0,125,0],[127,0,126,0],[128,0,127,0],[129,0,128,0],[130,0,129,0],[131,0,130,0],[132,0,131,0],[133,0,132,0],[134,0,133,0],[135,0,134,0],[136,0,135,0],[137,0,136,0],[138,0,137,0],[139,0,138,0],[140,0,139,0],[141,0,140,0],[142,0,141,0],[143,0,142,0],[144,0,143,0],[145,0,144,0],[146,0,145,0],[147,0,146,0],[148,0,147,0],[149,0,148,0],[150,0,149,0],[151,0,150,0],[152,0,151,0],[153,0,152,0],[154,0,153,0],[155,0,154,0],[156,0,155,0],[157,0,156,0],[158,0,157,0],[158,5,157,5],[159,4,158,2],[159,5,158,3],[160,4,160,2],[160,8,160,8,"handleMessage"],[160,21,160,21],[160,24,160,25,"event"],[160,29,160,35],[160,33,160,40],[161,6,161,4],[161,10,161,8],[162,8,162,6],[162,12,162,12,"data"],[162,16,162,16],[162,19,162,19,"JSON"],[162,23,162,23],[162,24,162,24,"parse"],[162,29,162,29],[162,30,162,30,"event"],[162,35,162,35],[162,36,162,36,"nativeEvent"],[162,47,162,47],[162,48,162,48,"data"],[162,52,162,52],[162,53,162,53],[163,8,163,6],[163,12,163,10,"data"],[163,16,163,14],[163,17,163,15,"type"],[163,21,163,19],[163,26,163,24],[163,39,163,37],[163,43,163,41,"onMarkerClick"],[163,56,163,54],[163,58,163,56],[164,10,164,8,"onMarkerClick"],[164,23,164,21],[164,24,164,22,"data"],[164,28,164,26],[164,29,164,27,"imei"],[164,33,164,31],[164,34,164,32],[165,8,165,6],[166,6,166,4],[166,7,166,5],[166,8,166,6],[166,15,166,13,"error"],[166,20,166,18],[166,22,166,20],[167,8,167,6,"console"],[167,15,167,13],[167,16,167,14,"error"],[167,21,167,19],[167,22,167,20],[167,54,167,52],[167,56,167,54,"error"],[167,61,167,59],[167,62,167,60],[168,6,168,4],[169,4,169,2],[169,5,169,3],[170,4,171,2],[170,24,172,4],[170,28,172,4,"_reactJsxDevRuntime"],[170,47,172,4],[170,48,172,4,"jsxDEV"],[170,54,172,4],[170,56,172,5,"_reactNative"],[170,68,172,9],[170,69,172,9,"View"],[170,73,172,9],[171,6,172,10,"style"],[171,11,172,15],[171,13,172,17,"styles"],[171,19,172,23],[171,20,172,24,"container"],[171,29,172,34],[172,6,172,34,"children"],[172,14,172,34],[172,29,173,6],[172,33,173,6,"_reactJsxDevRuntime"],[172,52,173,6],[172,53,173,6,"jsxDEV"],[172,59,173,6],[172,61,173,7,"_reactNativeWebview"],[172,80,173,14],[172,81,173,14,"WebView"],[172,88,173,14],[173,8,174,8,"source"],[173,14,174,14],[173,16,174,16],[174,10,174,18,"html"],[174,14,174,22],[174,16,174,24,"generateMapHTML"],[174,31,174,39],[174,32,174,40],[175,8,174,42],[175,9,174,44],[176,8,175,8,"style"],[176,13,175,13],[176,15,175,15,"styles"],[176,21,175,21],[176,22,175,22,"webview"],[176,29,175,30],[177,8,176,8,"onMessage"],[177,17,176,17],[177,19,176,19,"handleMessage"],[177,32,176,33],[178,8,177,8,"javaScriptEnabled"],[178,25,177,25],[178,27,177,27],[178,31,177,32],[179,8,178,8,"domStorageEnabled"],[179,25,178,25],[179,27,178,27],[179,31,178,32],[180,8,179,8,"originWhitelist"],[180,23,179,23],[180,25,179,25],[180,26,179,26],[180,29,179,29],[181,6,179,31],[182,8,179,31,"fileName"],[182,16,179,31],[182,18,179,31,"_jsxFileName"],[182,30,179,31],[183,8,179,31,"lineNumber"],[183,18,179,31],[184,8,179,31,"columnNumber"],[184,20,179,31],[185,6,179,31],[185,13,180,7],[186,4,180,8],[187,6,180,8,"fileName"],[187,14,180,8],[187,16,180,8,"_jsxFileName"],[187,28,180,8],[188,6,180,8,"lineNumber"],[188,16,180,8],[189,6,180,8,"columnNumber"],[189,18,180,8],[190,4,180,8],[190,11,181,10],[190,12,181,11],[191,2,183,0],[191,3,183,1],[192,2,183,2,"_c"],[192,4,183,2],[192,7,25,13,"LeafletMap"],[192,17,25,50],[193,2,185,0],[193,6,185,6,"styles"],[193,12,185,12],[193,15,185,15,"StyleSheet"],[193,27,185,25],[193,28,185,25,"StyleSheet"],[193,38,185,25],[193,39,185,26,"create"],[193,45,185,32],[193,46,185,33],[194,4,186,2,"container"],[194,13,186,11],[194,15,186,13],[195,6,187,4,"flex"],[195,10,187,8],[195,12,187,10],[196,4,188,2],[196,5,188,3],[197,4,189,2,"webview"],[197,11,189,9],[197,13,189,11],[198,6,190,4,"flex"],[198,10,190,8],[198,12,190,10],[199,4,191,2],[200,2,192,0],[200,3,192,1],[200,4,192,2],[201,2,194,0],[201,6,194,0,"_default"],[201,14,194,0],[201,17,194,15,"LeafletMap"],[201,27,194,25],[202,2,194,26],[202,6,194,26,"_c"],[202,8,194,26],[203,2,194,26,"$RefreshReg$"],[203,14,194,26],[203,15,194,26,"_c"],[203,17,194,26],[204,0,194,26],[204,3]],"functionMap":{"names":["<global>","LeafletMap","generateMapHTML","handleMessage"],"mappings":"AAA;qDCwB;0BCS;GD4H;wBEE;GFS;CDc"},"hasCjsExports":false},"type":"js/module"}]}