{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":26,"index":26}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":27},"end":{"line":2,"column":58,"index":85}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"react-native-webview","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":86},"end":{"line":3,"column":47,"index":133}}],"key":"YJc7i/oIweCWhKjzjfYLEcLeUJA=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/components/LeafletMap.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"LeafletMap\", {\n    enumerable: true,\n    get: function () {\n      return LeafletMap;\n    }\n  });\n  require(_dependencyMap[0], \"react\");\n  var _reactNative = require(_dependencyMap[1], \"react-native\");\n  var _reactNativeWebview = require(_dependencyMap[2], \"react-native-webview\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  var LeafletMap = _ref => {\n    var vehicles = _ref.vehicles,\n      onMarkerClick = _ref.onMarkerClick,\n      _ref$center = _ref.center,\n      center = _ref$center === void 0 ? [35.3764, 1.3218] : _ref$center,\n      _ref$zoom = _ref.zoom,\n      zoom = _ref$zoom === void 0 ? 13 : _ref$zoom,\n      _ref$focusedVehicleIm = _ref.focusedVehicleImei,\n      focusedVehicleImei = _ref$focusedVehicleIm === void 0 ? null : _ref$focusedVehicleIm;\n    // Generate HTML for Leaflet map\n    var generateMapHTML = () => {\n      var vehiclesJSON = JSON.stringify(vehicles);\n      var centerJSON = JSON.stringify(vehicles && vehicles.length > 0 ? [vehicles[0].lat, vehicles[0].lng] : center);\n      return `\n<!DOCTYPE html>\n<html>\n<head>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\n  <link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.css\" />\n  <script src=\"https://unpkg.com/leaflet@1.9.4/dist/leaflet.js\"></script>\n  <style>\n    body, html { margin: 0; padding: 0; height: 100%; }\n    #map { height: 100%; width: 100%; }\n  </style>\n</head>\n<body>\n  <div id=\"map\"></div>\n  <script>\n    const vehicles = ${vehiclesJSON};\n    const center = ${centerJSON};\n    \n    // Initialize map\n    const map = L.map('map').setView(center, ${zoom});\n    \n    // Add OpenStreetMap tiles\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution: '© OpenStreetMap contributors',\n      maxZoom: 19\n    }).addTo(map);\n    \n    // Add markers for each vehicle with arrow icons\n    vehicles.forEach(vehicle => {\n      // Create arrow SVG pointing in the direction of vehicle movement\n      const arrowSvg = \\`\n        <svg width=\"40\" height=\"50\" viewBox=\"0 0 40 50\" xmlns=\"http://www.w3.org/2000/svg\" \n             style=\"transform: rotate(\\${vehicle.angle}deg); filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));\">\n          <path d=\"M20 5 L35 30 L25 30 L25 45 L15 45 L15 30 L5 30 Z\" \n                fill=\"\\${vehicle.color}\" \n                stroke=\"white\" \n                stroke-width=\"2\"/>\n        </svg>\n      \\`;\n      \n      // Add vehicle name below the arrow\n      const icon = L.divIcon({\n        className: 'custom-vehicle-marker',\n        html: \\`\n          <div style=\"text-align: center; width: 80px; margin-left: -20px;\">\n            \\${arrowSvg}\n            <div style=\"\n              font-family: Arial, sans-serif;\n              font-size: 10px;\n              font-weight: bold;\n              color: #333;\n              background-color: rgba(255,255,255,0.9);\n              padding: 2px 4px;\n              border-radius: 3px;\n              margin-top: -5px;\n              box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n              white-space: nowrap;\n              overflow: hidden;\n              text-overflow: ellipsis;\n            \">\\${vehicle.name}</div>\n          </div>\n        \\`,\n        iconSize: [40, 65],\n        iconAnchor: [20, 45]\n      });\n      \n      const marker = L.marker([vehicle.lat, vehicle.lng], { icon })\n        .addTo(map)\n        .bindPopup(\\`\n          <div style=\"min-width: 150px; font-family: Arial, sans-serif;\">\n            <strong style=\"font-size: 16px; color: #333;\">\\${vehicle.name}</strong><br/>\n            <span style=\"font-size: 14px; color: #666;\">Vitesse: \\${vehicle.speed.toFixed(0)} km/h</span><br/>\n            <span style=\"font-size: 14px; color: #666;\">Direction: \\${vehicle.angle.toFixed(0)}°</span><br/>\n            <span style=\"font-size: 14px; color: #666;\">Statut: \\${vehicle.status}</span>\n          </div>\n        \\`);\n        \n      marker.on('click', () => {\n        if (window.ReactNativeWebView) {\n          window.ReactNativeWebView.postMessage(JSON.stringify({\n            type: 'markerClick',\n            imei: vehicle.imei\n          }));\n        }\n      });\n    });\n    \n    // Fit bounds to show all vehicles\n    if (vehicles.length > 0) {\n      const bounds = vehicles.map(v => [v.lat, v.lng]);\n      map.fitBounds(bounds, { padding: [50, 50] });\n    }\n  </script>\n</body>\n</html>\n    `;\n    };\n    var handleMessage = event => {\n      try {\n        var data = JSON.parse(event.nativeEvent.data);\n        if (data.type === 'markerClick' && onMarkerClick) {\n          onMarkerClick(data.imei);\n        }\n      } catch (error) {\n        console.error('Error parsing WebView message:', error);\n      }\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNative.View, {\n      style: styles.container,\n      children: /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(_reactNativeWebview.WebView, {\n        source: {\n          html: generateMapHTML()\n        },\n        style: styles.webview,\n        onMessage: handleMessage,\n        javaScriptEnabled: true,\n        domStorageEnabled: true,\n        originWhitelist: ['*']\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 5\n    }, this);\n  };\n  _c = LeafletMap;\n  var styles = _reactNative.StyleSheet.create({\n    container: {\n      flex: 1\n    },\n    webview: {\n      flex: 1\n    }\n  });\n  var _default = LeafletMap;\n  var _c;\n  $RefreshReg$(_c, \"LeafletMap\");\n});","lineCount":178,"map":[[8,2,168,0,"Object"],[8,8,168,0],[8,9,168,0,"defineProperty"],[8,23,168,0],[8,24,168,0,"exports"],[8,31,168,0],[9,4,168,0,"enumerable"],[9,14,168,0],[10,4,168,0,"get"],[10,7,168,0],[10,18,168,0,"get"],[10,19,168,0],[11,6,168,0],[11,13,168,0,"_default"],[11,21,168,0],[12,4,168,0],[13,2,168,0],[14,2,24,0,"Object"],[14,8,24,0],[14,9,24,0,"defineProperty"],[14,23,24,0],[14,24,24,0,"exports"],[14,31,24,0],[15,4,24,0,"enumerable"],[15,14,24,0],[16,4,24,0,"get"],[16,7,24,0],[16,18,24,0,"get"],[16,19,24,0],[17,6,24,0],[17,13,24,0,"LeafletMap"],[17,23,24,0],[18,4,24,0],[19,2,24,0],[20,2,1,0,"require"],[20,9,1,0],[20,10,1,0,"_dependencyMap"],[20,24,1,0],[21,2,2,0],[21,6,2,0,"_reactNative"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_reactNativeWebview"],[22,25,3,0],[22,28,3,0,"require"],[22,35,3,0],[22,36,3,0,"_dependencyMap"],[22,50,3,0],[23,2,3,47],[23,6,3,47,"_reactJsxDevRuntime"],[23,25,3,47],[23,28,3,47,"require"],[23,35,3,47],[23,36,3,47,"_dependencyMap"],[23,50,3,47],[24,2,24,7],[24,6,24,13,"LeafletMap"],[24,16,24,50],[24,19,24,53,"_ref"],[24,23,24,53],[24,27,30,6],[25,4,30,6],[25,8,25,2,"vehicles"],[25,16,25,10],[25,19,25,10,"_ref"],[25,23,25,10],[25,24,25,2,"vehicles"],[25,32,25,10],[26,6,26,2,"onMarkerClick"],[26,19,26,15],[26,22,26,15,"_ref"],[26,26,26,15],[26,27,26,2,"onMarkerClick"],[26,40,26,15],[27,6,26,15,"_ref$center"],[27,17,26,15],[27,20,26,15,"_ref"],[27,24,26,15],[27,25,27,2,"center"],[27,31,27,8],[28,6,27,2,"center"],[28,12,27,8],[28,15,27,8,"_ref$center"],[28,26,27,8],[28,40,27,11],[28,41,27,12],[28,48,27,19],[28,50,27,21],[28,56,27,27],[28,57,27,28],[28,60,27,28,"_ref$center"],[28,71,27,28],[29,6,27,28,"_ref$zoom"],[29,15,27,28],[29,18,27,28,"_ref"],[29,22,27,28],[29,23,28,2,"zoom"],[29,27,28,6],[30,6,28,2,"zoom"],[30,10,28,6],[30,13,28,6,"_ref$zoom"],[30,22,28,6],[30,36,28,9],[30,38,28,11],[30,41,28,11,"_ref$zoom"],[30,50,28,11],[31,6,28,11,"_ref$focusedVehicleIm"],[31,27,28,11],[31,30,28,11,"_ref"],[31,34,28,11],[31,35,29,2,"focusedVehicleImei"],[31,53,29,20],[32,6,29,2,"focusedVehicleImei"],[32,24,29,20],[32,27,29,20,"_ref$focusedVehicleIm"],[32,48,29,20],[32,62,29,23],[32,66,29,27],[32,69,29,27,"_ref$focusedVehicleIm"],[32,90,29,27],[33,4,31,2],[34,4,32,2],[34,8,32,8,"generateMapHTML"],[34,23,32,23],[34,26,32,26,"generateMapHTML"],[34,27,32,26],[34,32,32,32],[35,6,33,4],[35,10,33,10,"vehiclesJSON"],[35,22,33,22],[35,25,33,25,"JSON"],[35,29,33,29],[35,30,33,30,"stringify"],[35,39,33,39],[35,40,33,40,"vehicles"],[35,48,33,48],[35,49,33,49],[36,6,34,4],[36,10,34,10,"centerJSON"],[36,20,34,20],[36,23,34,23,"JSON"],[36,27,34,27],[36,28,34,28,"stringify"],[36,37,34,37],[36,38,34,38,"vehicles"],[36,46,34,46],[36,50,34,50,"vehicles"],[36,58,34,58],[36,59,34,59,"length"],[36,65,34,65],[36,68,34,68],[36,69,34,69],[36,72,34,72],[36,73,34,73,"vehicles"],[36,81,34,81],[36,82,34,82],[36,83,34,83],[36,84,34,84],[36,85,34,85,"lat"],[36,88,34,88],[36,90,34,90,"vehicles"],[36,98,34,98],[36,99,34,99],[36,100,34,100],[36,101,34,101],[36,102,34,102,"lng"],[36,105,34,105],[36,106,34,106],[36,109,34,109,"center"],[36,115,34,115],[36,116,34,116],[37,6,36,4],[37,13,36,11],[38,0,37,0],[39,0,38,0],[40,0,39,0],[41,0,40,0],[42,0,41,0],[43,0,42,0],[44,0,43,0],[45,0,44,0],[46,0,45,0],[47,0,46,0],[48,0,47,0],[49,0,48,0],[50,0,49,0],[51,0,50,0],[52,0,51,0],[52,23,51,23,"vehiclesJSON"],[52,35,51,35],[53,0,52,0],[53,21,52,21,"centerJSON"],[53,31,52,31],[54,0,53,0],[55,0,54,0],[56,0,55,0],[56,47,55,47,"zoom"],[56,51,55,51],[57,0,56,0],[58,0,57,0],[59,0,58,0],[60,0,59,0],[61,0,60,0],[62,0,61,0],[63,0,62,0],[64,0,63,0],[65,0,64,0],[66,0,65,0],[67,0,66,0],[68,0,67,0],[69,0,68,0],[70,0,69,0],[71,0,70,0],[72,0,71,0],[73,0,72,0],[74,0,73,0],[75,0,74,0],[76,0,75,0],[77,0,76,0],[78,0,77,0],[79,0,78,0],[80,0,79,0],[81,0,80,0],[82,0,81,0],[83,0,82,0],[84,0,83,0],[85,0,84,0],[86,0,85,0],[87,0,86,0],[88,0,87,0],[89,0,88,0],[90,0,89,0],[91,0,90,0],[92,0,91,0],[93,0,92,0],[94,0,93,0],[95,0,94,0],[96,0,95,0],[97,0,96,0],[98,0,97,0],[99,0,98,0],[100,0,99,0],[101,0,100,0],[102,0,101,0],[103,0,102,0],[104,0,103,0],[105,0,104,0],[106,0,105,0],[107,0,106,0],[108,0,107,0],[109,0,108,0],[110,0,109,0],[111,0,110,0],[112,0,111,0],[113,0,112,0],[114,0,113,0],[115,0,114,0],[116,0,115,0],[117,0,116,0],[118,0,117,0],[119,0,118,0],[120,0,119,0],[121,0,120,0],[122,0,121,0],[123,0,122,0],[124,0,123,0],[125,0,124,0],[126,0,125,0],[127,0,126,0],[128,0,127,0],[129,0,128,0],[130,0,129,0],[131,0,130,0],[132,0,131,0],[132,5,131,5],[133,4,132,2],[133,5,132,3],[134,4,134,2],[134,8,134,8,"handleMessage"],[134,21,134,21],[134,24,134,25,"event"],[134,29,134,35],[134,33,134,40],[135,6,135,4],[135,10,135,8],[136,8,136,6],[136,12,136,12,"data"],[136,16,136,16],[136,19,136,19,"JSON"],[136,23,136,23],[136,24,136,24,"parse"],[136,29,136,29],[136,30,136,30,"event"],[136,35,136,35],[136,36,136,36,"nativeEvent"],[136,47,136,47],[136,48,136,48,"data"],[136,52,136,52],[136,53,136,53],[137,8,137,6],[137,12,137,10,"data"],[137,16,137,14],[137,17,137,15,"type"],[137,21,137,19],[137,26,137,24],[137,39,137,37],[137,43,137,41,"onMarkerClick"],[137,56,137,54],[137,58,137,56],[138,10,138,8,"onMarkerClick"],[138,23,138,21],[138,24,138,22,"data"],[138,28,138,26],[138,29,138,27,"imei"],[138,33,138,31],[138,34,138,32],[139,8,139,6],[140,6,140,4],[140,7,140,5],[140,8,140,6],[140,15,140,13,"error"],[140,20,140,18],[140,22,140,20],[141,8,141,6,"console"],[141,15,141,13],[141,16,141,14,"error"],[141,21,141,19],[141,22,141,20],[141,54,141,52],[141,56,141,54,"error"],[141,61,141,59],[141,62,141,60],[142,6,142,4],[143,4,143,2],[143,5,143,3],[144,4,145,2],[144,24,146,4],[144,28,146,4,"_reactJsxDevRuntime"],[144,47,146,4],[144,48,146,4,"jsxDEV"],[144,54,146,4],[144,56,146,5,"_reactNative"],[144,68,146,9],[144,69,146,9,"View"],[144,73,146,9],[145,6,146,10,"style"],[145,11,146,15],[145,13,146,17,"styles"],[145,19,146,23],[145,20,146,24,"container"],[145,29,146,34],[146,6,146,34,"children"],[146,14,146,34],[146,29,147,6],[146,33,147,6,"_reactJsxDevRuntime"],[146,52,147,6],[146,53,147,6,"jsxDEV"],[146,59,147,6],[146,61,147,7,"_reactNativeWebview"],[146,80,147,14],[146,81,147,14,"WebView"],[146,88,147,14],[147,8,148,8,"source"],[147,14,148,14],[147,16,148,16],[148,10,148,18,"html"],[148,14,148,22],[148,16,148,24,"generateMapHTML"],[148,31,148,39],[148,32,148,40],[149,8,148,42],[149,9,148,44],[150,8,149,8,"style"],[150,13,149,13],[150,15,149,15,"styles"],[150,21,149,21],[150,22,149,22,"webview"],[150,29,149,30],[151,8,150,8,"onMessage"],[151,17,150,17],[151,19,150,19,"handleMessage"],[151,32,150,33],[152,8,151,8,"javaScriptEnabled"],[152,25,151,25],[152,27,151,27],[152,31,151,32],[153,8,152,8,"domStorageEnabled"],[153,25,152,25],[153,27,152,27],[153,31,152,32],[154,8,153,8,"originWhitelist"],[154,23,153,23],[154,25,153,25],[154,26,153,26],[154,29,153,29],[155,6,153,31],[156,8,153,31,"fileName"],[156,16,153,31],[156,18,153,31,"_jsxFileName"],[156,30,153,31],[157,8,153,31,"lineNumber"],[157,18,153,31],[158,8,153,31,"columnNumber"],[158,20,153,31],[159,6,153,31],[159,13,154,7],[160,4,154,8],[161,6,154,8,"fileName"],[161,14,154,8],[161,16,154,8,"_jsxFileName"],[161,28,154,8],[162,6,154,8,"lineNumber"],[162,16,154,8],[163,6,154,8,"columnNumber"],[163,18,154,8],[164,4,154,8],[164,11,155,10],[164,12,155,11],[165,2,157,0],[165,3,157,1],[166,2,157,2,"_c"],[166,4,157,2],[166,7,24,13,"LeafletMap"],[166,17,24,50],[167,2,159,0],[167,6,159,6,"styles"],[167,12,159,12],[167,15,159,15,"StyleSheet"],[167,27,159,25],[167,28,159,25,"StyleSheet"],[167,38,159,25],[167,39,159,26,"create"],[167,45,159,32],[167,46,159,33],[168,4,160,2,"container"],[168,13,160,11],[168,15,160,13],[169,6,161,4,"flex"],[169,10,161,8],[169,12,161,10],[170,4,162,2],[170,5,162,3],[171,4,163,2,"webview"],[171,11,163,9],[171,13,163,11],[172,6,164,4,"flex"],[172,10,164,8],[172,12,164,10],[173,4,165,2],[174,2,166,0],[174,3,166,1],[174,4,166,2],[175,2,168,0],[175,6,168,0,"_default"],[175,14,168,0],[175,17,168,15,"LeafletMap"],[175,27,168,25],[176,2,168,26],[176,6,168,26,"_c"],[176,8,168,26],[177,2,168,26,"$RefreshReg$"],[177,14,168,26],[177,15,168,26,"_c"],[177,17,168,26],[178,0,168,26],[178,3]],"functionMap":{"names":["<global>","LeafletMap","generateMapHTML","handleMessage"],"mappings":"AAA;qDCuB;0BCQ;GDoG;wBEE;GFS;CDc"},"hasCjsExports":false},"type":"js/module"}]}